@if (match && match.match_id) {
  <form tuiTextfieldSize="m" [formGroup]="eventForm">
    @if (
      events && events.length && eventForm && eventsArray && eventsArray.length
    ) {
      <div class="event-table">
        <div formArrayName="events" class="event-table-body">
          @for (
            eventFormGroup of eventsArray.controls;
            track eventFormGroup;
            let i = $index
          ) {
            <div class="event-table-row" [formGroupName]="i">
              @if (!isExpanded(i)) {
                <div
                  class="event-short-view-container"
                  [style.background-color]="
                    isCautionColorResult(eventsArray, i)
                  "
                >
                  <div
                    class="event-table-cell toggle"
                    (click)="toggle(i)"
                    (keyup.enter)="toggle(i)"
                    tabindex="0"
                  >
                    <app-button-icon
                      [buttonIcon]="isExpanded(i) ? '@tui.x' : '@tui.ellipsis'"
                      [buttonSize]="'m'"
                    ></app-button-icon>
                  </div>
                  <app-football-event-short-view
                    [eventsArray]="eventsArray"
                    [i]="i"
                    [maxFieldLength]="match.match_data?.field_length"
                  ></app-football-event-short-view>
                </div>
              } @else {
                <!--EVENT NUMBER-->
                <div class="event-num-qtr-row">
                  <div
                    class="event-table-cell toggle"
                    (click)="toggle(i)"
                    (keyup.enter)="toggle(i)"
                    tabindex="0"
                  >
                    <app-button-icon
                      [buttonIcon]="isExpanded(i) ? '@tui.x' : '@tui.ellipsis'"
                      [buttonSize]="'m'"
                    ></app-button-icon>
                  </div>
                  @if (
                    getEventNumberFormControl(
                      this.eventForm,
                      this.arrayName,
                      i
                    );
                    as control
                  ) {
                    <div class="event-table-cell">
                      <app-input-number-with-buttons
                        [control]="control"
                        [label]="'num'"
                        [index]="i"
                        [key]="eventNumberKey"
                        (numberChanged)="handleFieldChange($event)"
                      ></app-input-number-with-buttons>
                    </div>
                  }
                  <!--EVENT QTR-->
                  @if (
                    getQtrFormControl(this.eventForm, this.arrayName, i);
                    as control
                  ) {
                    <div class="event-table-cell">
                      <app-input-number-with-buttons
                        [label]="'Qtr'"
                        [control]="control"
                        [index]="i"
                        [key]="eventQtrKey"
                        [min]="1"
                        [max]="4"
                        (numberChanged)="handleFieldChange($event)"
                      ></app-input-number-with-buttons>
                    </div>
                  }
                </div>
                <!--EVENT TEAM-->
                @if (
                  getEventTeamFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  <div class="event-table-cell">
                    @if (
                      match &&
                      match.teams_data &&
                      match.teams_data.team_a &&
                      match.teams_data.team_b
                    ) {
                      <app-select-team-in-match
                        [placeholder]="'offence team'"
                        [teamsList]="[
                          match.teams_data.team_a,
                          match.teams_data.team_b,
                        ]"
                        [control]="control"
                        (teamSelected)="onTeamChange(eventsArray, $event, i)"
                      ></app-select-team-in-match>
                    }
                  </div>
                }
                <!--EVENT QB-->
                @if (
                  getEventQbFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  <div
                    class="event-table-cell"
                    [style.background-color]="
                      isMaxCautionColor(isQb(eventsArray, i))
                    "
                  >
                    @if (getEventTeam(eventsArray, i); as selectedTeam) {
                      @if (!isKickOffPlay(eventsArray, i)) {
                        @if (isMobile) {
                          <app-select-player-in-match
                            [placeholder]="'qb'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'qb'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      }
                    }
                  </div>
                }
                <!--EVENT DOWN-->
                <div class="event-table-cell">
                  <div
                    class="event-down-distance"
                    [style.background-color]="
                      isMaxCautionColor(noDownSelected(eventsArray, i))
                    "
                  >
                    @if (
                      getEventDownFormControl(
                        this.eventForm,
                        this.arrayName,
                        i
                      );
                      as control
                    ) {
                      <div class="event-down">
                        <app-input-number-with-buttons
                          [label]="'down'"
                          [control]="control"
                          [index]="i"
                          [key]="eventDownKey"
                          [min]="1"
                          [max]="4"
                          [eventsArray]="eventsArray"
                          (numberChanged)="handleFieldChange($event)"
                          [onDownChange]="onDownChange"
                        ></app-input-number-with-buttons>
                      </div>
                    }
                    @if (
                      getEventDistanceFormControl(
                        this.eventForm,
                        this.arrayName,
                        i
                      );
                      as control
                    ) {
                      @if (
                        isDistanceOrGoal(
                          getEventDistance(eventsArray, i),
                          getEventBallOn(eventsArray, i),
                          getEventPlayType(eventsArray, i)
                        )
                      ) {
                        <div
                          class="event-distance"
                          [style.background-color]="
                            isMaxCautionColor(
                              noDistanceSelected(eventsArray, i)
                            )
                          "
                        >
                          <app-input-number-with-buttons
                            [label]="'Dist'"
                            [control]="control"
                            [index]="i"
                            [key]="eventDistanceKey"
                            [min]="1"
                            [max]="100"
                            (numberChanged)="handleFieldChange($event)"
                          ></app-input-number-with-buttons>
                        </div>
                      } @else {
                        <span class="tui-text_h6">& GOAL</span>
                      }
                    }
                  </div>
                </div>
                <!--BALL ON-->
                @if (
                  getBallOnFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  <div
                    class="event-table-cell"
                    [style.background-color]="
                      isMaxCautionColor(noBallOnIsSelected(eventsArray, i))
                    "
                  >
                    @if (match.match_data?.field_length; as fieldLength) {
                      <app-input-numbers-with-increment-buttons
                        [label]="'BallOn'"
                        [control]="control"
                        [min]="-(fieldLength / 2 - 1)"
                        [max]="fieldLength / 2"
                        (incrementEvent)="
                          incrementBallOnPosition(
                            getEventBallOn(eventsArray, i),
                            $event,
                            control,
                            eventsArray,
                            i,
                            fieldLength,
                            eventBallOnKey
                          )
                        "
                        (valueChanged)="
                          onBallOnChange(
                            events,
                            eventsArray,
                            $event,
                            i,
                            fieldLength / 2
                          )
                        "
                      ></app-input-numbers-with-increment-buttons>
                    }
                  </div>
                }
                <!--HASH-->
                @if (
                  getEventHashFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  @if (!isKickOffPlay(eventsArray, i)) {
                    <div class="event-table-cell">
                      <app-football-events-hash-buttons
                        [control]="control"
                        [eventsArray]="eventsArray"
                        [i]="i"
                      ></app-football-events-hash-buttons>
                    </div>
                  }
                }
                <!--STRONG SIDE-->
                @if (
                  getEventStrongSideFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (
                    !isKickOffPlay(eventsArray, i) &&
                    !isPatOnePlay(eventsArray, i) &&
                    !isKickPlay(eventsArray, i)
                  ) {
                    <div class="event-table-cell">
                      <app-football-events-strong-side-buttons
                        [control]="control"
                        [eventsArray]="eventsArray"
                        [i]="i"
                      ></app-football-events-strong-side-buttons>
                    </div>
                  }
                }
                <!--EVENT PLAY TYPE-->
                @if (
                  getEventPlayTypeFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  <hr />
                  <div class="event-table-cell">
                    @if (isMobile) {
                      @if (!isKickOffPlay(eventsArray, i)) {
                        <app-football-events-play-type-buttons
                          [control]="control"
                          [eventsArray]="eventsArray"
                          [i]="i"
                        ></app-football-events-play-type-buttons>
                      }
                      <app-select-list-of-strings
                        [control]="control"
                        [placeholder]="'play type'"
                        [stringList]="eventPlayTypeOptions"
                        (itemSelected)="
                          handlePlayTypeChange(
                            eventsArray,
                            getEventPlayType(eventsArray, i),
                            i
                          )
                        "
                      ></app-select-list-of-strings>
                    } @else {
                      <app-search-list-of-strings
                        [control]="control"
                        [placeholder]="'play type'"
                        [stringList]="eventPlayTypeOptions"
                        (itemSelected)="
                          handlePlayTypeChange(
                            eventsArray,
                            getEventPlayType(eventsArray, i),
                            i
                          )
                        "
                      ></app-search-list-of-strings>
                    }
                  </div>
                  <hr />
                }
                <!--EVENT KICK PLAYER-->
                @if (
                  getEventKickPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isKickPlay(eventsArray, i) ||
                      getEventKickPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isKickPlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'kick player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'kick player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT KICKOFF PLAYER-->
                @if (
                  getEventKickOffPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isKickOffPlay(eventsArray, i) ||
                      getEventKickOffPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isKickOffPlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'kickoff player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'kickoff player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT PAT ONE PLAYER-->
                @if (
                  getEventPatOnePlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isPatOnePlay(eventsArray, i) ||
                      getEventPatOnePlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isPatOnePlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'pat one player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'pat one player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT PUNT PLAYER-->
                @if (
                  getEventPuntPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isPuntPlay(eventsArray, i) ||
                      getEventPuntPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isPuntPlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'punt player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'punt player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT PLAY RESULT-->
                @if (
                  getEventPlayResultFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  <hr />
                  <div class="event-table-cell">
                    @if (isMobile) {
                      <app-football-events-play-result-buttons
                        [control]="control"
                        [eventsArray]="eventsArray"
                        [i]="i"
                      ></app-football-events-play-result-buttons>
                      @if (
                        !isKickOffPlay(eventsArray, i) &&
                        !isPassPlay(eventsArray, i) &&
                        !isRunPlay(eventsArray, i)
                      ) {
                        <app-select-list-of-strings
                          [control]="control"
                          [placeholder]="'play result'"
                          [stringList]="
                            filterPlayResultsByType(
                              getEventPlayType(eventsArray, i)
                            )
                          "
                          (itemSelected)="
                            handlePlayResultChange(
                              eventsArray,
                              getEventPlayResult(eventsArray, i),
                              i
                            )
                          "
                        ></app-select-list-of-strings>
                      }
                    } @else {
                      <app-search-list-of-strings
                        [control]="control"
                        [placeholder]="'play result'"
                        [stringList]="
                          filterPlayResultsByType(
                            getEventPlayType(eventsArray, i)
                          )
                        "
                      ></app-search-list-of-strings>
                    }
                  </div>
                  <hr />
                }
                <!--EVENT RUN PLAYER-->
                @if (
                  getEventRunPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isRunPlay(eventsArray, i) ||
                      getEventRunPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isRunPlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [placeholder]="'run player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'run player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT RECEIVER PLAYER-->
                @if (
                  getEventReceiverPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isPassCompletedPlay(eventsArray, i) ||
                      getEventReceiverPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isReceiverPlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [placeholder]="'receiver player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'receiver player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT DROPPED PLAYER-->
                @if (
                  getEventDroppedPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isPassDroppedPlay(eventsArray, i) ||
                      getEventDroppedPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isDroppedPlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'dropped player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'dropped player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--DIRECTION-->
                @if (
                  getEventHashFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  @if (
                    !isPatOnePlay(eventsArray, i) && !isKickPlay(eventsArray, i)
                  ) {
                    <div class="event-table-cell">
                      <app-football-events-direction-buttons
                        [control]="control"
                        [eventsArray]="eventsArray"
                        [i]="i"
                      ></app-football-events-direction-buttons>
                    </div>
                  }
                }
                <!--EVENT BALL MOVED-->
                @if (
                  getBallMovedOnFormControl(this.eventForm, this.arrayName, i);
                  as control
                ) {
                  @if (
                    getEventPlayType(eventsArray, i) ===
                      IFootballPlayType.Pass ||
                    getEventPlayType(eventsArray, i) ===
                      IFootballPlayType.Run ||
                    getEventPlayResult(eventsArray, i) ===
                      IFootballPlayResult.Flag
                  ) {
                    <div class="event-ballon-distance">
                      @if (match.match_data?.field_length; as fieldLength) {
                        <div
                          class="event-table-cell"
                          [style.background-color]="
                            isCautionColor(
                              noBallMovedIsSelected(eventsArray, i)
                            )
                          "
                        >
                          <app-input-numbers-with-increment-buttons
                            [label]="'Ball Moved'"
                            [control]="control"
                            [min]="-(fieldLength / 2 - 1)"
                            [max]="fieldLength / 2"
                            (incrementEvent)="
                              incrementBallOnPosition(
                                getEventBallMovedOn(eventsArray, i),
                                $event,
                                control,
                                eventsArray,
                                i,
                                fieldLength,
                                eventBallMovedOnKey
                              )
                            "
                          ></app-input-numbers-with-increment-buttons>
                        </div>
                        <span class="tui-text_h6"
                          >Dist:
                          {{
                            computeDistance(
                              getEventBallMovedOn(eventsArray, i),
                              getEventBallOn(eventsArray, i),
                              fieldLength / 2
                            )
                          }}</span
                        >
                      }
                    </div>
                  }
                }
                <!--EVENT RETURN PLAYER-->
                @if (
                  getEventReturnPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isReturnPlay(eventsArray, i) ||
                      getEventReturnPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isReturnPlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'return player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'return player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--BALL KICKED & BALL RETURN-->
                @if (
                  getEventBallKickedToFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (isReturnPlayOrKickOut(eventsArray, i)) {
                    <div class="event-ballon-distance">
                      <div
                        [style.background-color]="
                          isCautionColor(noKickBallToIsSelected(eventsArray, i))
                        "
                      >
                        @if (match.match_data?.field_length; as fieldLength) {
                          <app-input-numbers-with-increment-buttons
                            [label]="'Ball Kicked'"
                            [control]="control"
                            [min]="-(fieldLength / 2 - 1)"
                            [max]="fieldLength / 2"
                            (incrementEvent)="
                              incrementBallOnPosition(
                                getEventBallKickedTo(eventsArray, i),
                                $event,
                                control,
                                eventsArray,
                                i,
                                fieldLength,
                                eventBallKickedToKey
                              )
                            "
                            (valueChanged)="
                              onKickBallChange(eventsArray, i, $event)
                            "
                            [plusOne]="-1"
                            [minusOne]="1"
                          ></app-input-numbers-with-increment-buttons>
                        }
                      </div>
                      @if (
                        getEventBallReturnedToFormControl(
                          this.eventForm,
                          this.arrayName,
                          i
                        );
                        as control
                      ) {
                        <div
                          [style.background-color]="
                            isCautionColor(
                              noReturnBallToIsSelected(eventsArray, i)
                            )
                          "
                        >
                          @if (match.match_data?.field_length; as fieldLength) {
                            <app-input-numbers-with-increment-buttons
                              [label]="'Ball Returned'"
                              [control]="control"
                              [min]="-(fieldLength / 2 - 1)"
                              [max]="fieldLength / 2"
                              (incrementEvent)="
                                incrementBallOnPosition(
                                  getEventBallReturnedTo(eventsArray, i),
                                  $event,
                                  control,
                                  eventsArray,
                                  i,
                                  fieldLength,
                                  eventBallReturnedToKey
                                )
                              "
                              [plusOne]="-1"
                              [minusOne]="1"
                            ></app-input-numbers-with-increment-buttons>
                          }
                        </div>
                      }
                    </div>
                  }
                }
                <!--EVENT TACKLE PLAYER-->
                @if (
                  getEventTacklePlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isTacklePossible(eventsArray, i) ||
                      getEventTacklePlayer(eventsArray, i)
                    ) {
                      @if (isReturnPlay(eventsArray, i)) {
                        <div class="event-table-cell">
                          @if (isMobile) {
                            <app-select-player-in-match
                              [players]="
                                getPlayersForSelectedTeam(selectedTeam)
                              "
                              [control]="control"
                              [placeholder]="'tackle player'"
                            ></app-select-player-in-match>
                          } @else {
                            <app-search-player-in-match-autocomplete
                              [action]="'select'"
                              [placeholder]="'tackle player'"
                              [players]="
                                getPlayersForSelectedTeam(selectedTeam)
                              "
                              [control]="control"
                            >
                            </app-search-player-in-match-autocomplete>
                          }
                        </div>
                      } @else {
                        <div class="event-table-cell">
                          @if (isMobile) {
                            <app-select-player-in-match
                              [players]="getDefencePlayersForTeam(selectedTeam)"
                              [control]="control"
                              [placeholder]="'tackle player'"
                            ></app-select-player-in-match>
                          } @else {
                            <app-search-player-in-match-autocomplete
                              [action]="'select'"
                              [placeholder]="'tackle player'"
                              [players]="getDefencePlayersForTeam(selectedTeam)"
                              [control]="control"
                            >
                            </app-search-player-in-match-autocomplete>
                          }
                        </div>
                      }
                    }
                  }
                }
                <!--EVENT ASSIST TACKLE PLAYER-->
                @if (
                  getEventAssistTacklePlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isTacklePossible(eventsArray, i) ||
                      getEventTacklePlayer(eventsArray, i)
                    ) {
                      @if (isReturnPlay(eventsArray, i)) {
                        <div class="event-table-cell">
                          @if (isMobile) {
                            <app-select-player-in-match
                              [players]="
                                getPlayersForSelectedTeam(selectedTeam)
                              "
                              [control]="control"
                              [placeholder]="'assist tackle player'"
                            ></app-select-player-in-match>
                          } @else {
                            <app-search-player-in-match-autocomplete
                              [action]="'select'"
                              [placeholder]="'assist tackle player'"
                              [players]="
                                getPlayersForSelectedTeam(selectedTeam)
                              "
                              [control]="control"
                            >
                            </app-search-player-in-match-autocomplete>
                          }
                        </div>
                      } @else {
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'assist tackle player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'assist tackle player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      }
                    }
                  }
                }
                <!--EVENT SCORE PLAYER-->
                @if (
                  getEventScorePlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isScoreTDPatTwoOffence(eventsArray, i) ||
                      getEventScorePlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isScorePlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'score player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'score player'"
                            [players]="getPlayersForSelectedTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT DEFLECTED PLAYER-->
                @if (
                  getEventDeflectedPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isDeflectResult(eventsArray, i) ||
                      getEventDeflectedPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isDeflectPlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'deflected player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'deflected player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT INTERCEPTED PLAYER-->
                @if (
                  getEventInterceptedPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isInterceptResult(eventsArray, i) ||
                      getEventInterceptedPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isInterceptedPlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'intercepted player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'intercepted player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--BALL PICKED & BALL RETURN-->
                @if (
                  getEventBallPickedOnFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (isInterception(eventsArray, i)) {
                    <div class="event-ballon-distance">
                      <div
                        [style.background-color]="
                          isCautionColor(
                            noPickBallOnInterceptionIsSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (
                          match && match.match_data?.field_length;
                          as fieldLength
                        ) {
                          <app-input-numbers-with-increment-buttons
                            [label]="'Ball Picked'"
                            [control]="control"
                            [min]="-(fieldLength / 2 - 1)"
                            [max]="fieldLength / 2"
                            (incrementEvent)="
                              incrementBallOnPosition(
                                getEventBallPickedOn(eventsArray, i),
                                $event,
                                control,
                                eventsArray,
                                i,
                                fieldLength,
                                eventBallPickedOnKey
                              )
                            "
                          ></app-input-numbers-with-increment-buttons>
                        }
                      </div>
                      @if (
                        getEventBallReturnedToFormControl(
                          this.eventForm,
                          this.arrayName,
                          i
                        );
                        as control
                      ) {
                        <div
                          [style.background-color]="
                            isCautionColor(
                              noReturnBallToIsSelected(eventsArray, i)
                            )
                          "
                        >
                          @if (
                            match && match.match_data?.field_length;
                            as fieldLength
                          ) {
                            <app-input-numbers-with-increment-buttons
                              [label]="'Ball Returned'"
                              [control]="control"
                              [min]="-(fieldLength / 2 - 1)"
                              [max]="fieldLength / 2"
                              (incrementEvent)="
                                incrementBallOnPosition(
                                  getEventBallReturnedTo(eventsArray, i),
                                  $event,
                                  control,
                                  eventsArray,
                                  i,
                                  fieldLength,
                                  eventBallReturnedToKey
                                )
                              "
                              [plusOne]="-1"
                              [minusOne]="1"
                            ></app-input-numbers-with-increment-buttons>
                          }
                        </div>
                      }
                    </div>
                  }
                }
                <!--EVENT SACK PLAYER-->
                @if (
                  getEventSackPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isSackResult(eventsArray, i) ||
                      getEventSackPlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(isSackPlayerSelected(eventsArray, i))
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'sack player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'sack player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT SCORE RESULT-->
                @if (
                  getEventScoreResultFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (isScorePossible(eventsArray, i)) {
                    <div class="event-table-cell">
                      @if (isMobile) {
                        <app-select-list-of-strings
                          [control]="control"
                          [placeholder]="'score result'"
                          [stringList]="
                            filterScoreResultsByType(
                              getEventPlayType(eventsArray, i)
                            )
                          "
                          (itemSelected)="
                            handleScoreResultChange(eventsArray, i)
                          "
                        ></app-select-list-of-strings>
                      } @else {
                        <app-search-list-of-strings
                          [control]="control"
                          [placeholder]="'score result'"
                          [stringList]="
                            filterScoreResultsByType(
                              getEventPlayType(eventsArray, i)
                            )
                          "
                          (itemSelected)="
                            handleScoreResultChange(eventsArray, i)
                          "
                        ></app-search-list-of-strings>
                      }
                    </div>
                  }
                }
                <div class="event-fumble">
                  <div class="event-is-fumble">
                    <!--EVENT IS FUMBLE-->
                    @if (
                      getEventIsFumbleFormControl(
                        this.eventForm,
                        this.arrayName,
                        i
                      );
                      as control
                    ) {
                      @if (
                        !isPlayResultWithIndex(
                          eventFormGroup,
                          i,
                          eventPlayResultKey,
                          IFootballPlayResult.Flag
                        )
                      ) {
                        <div class="event-table-cell">
                          <label [attr.for]="'is-fumble-' + i"
                            >Is Fumble?</label
                          >
                          <input
                            tuiSwitch
                            type="checkbox"
                            [formControl]="control"
                            size="m"
                            [id]="'is-fumble-' + i"
                          />
                        </div>
                      }
                    }
                  </div>
                  @if (
                    getEventFumblePlayerFormControl(
                      this.eventForm,
                      this.arrayName,
                      i
                    );
                    as control
                  ) {
                    @if (getEventTeam(eventsArray, i); as selectedTeam) {
                      @if (
                        (!isPlayResultWithIndex(
                          eventFormGroup,
                          i,
                          eventPlayResultKey,
                          IFootballPlayResult.Flag
                        ) &&
                          getEventIsFumble(eventsArray, i)) ||
                        getEventFumblePlayer(eventsArray, i)
                      ) {
                        <div class="event-table-cell">
                          @if (isMobile) {
                            <app-select-player-in-match
                              [players]="getDefencePlayersForTeam(selectedTeam)"
                              [control]="control"
                              [placeholder]="'forced player'"
                            ></app-select-player-in-match>
                          } @else {
                            <app-search-player-in-match-autocomplete
                              [action]="'select'"
                              [placeholder]="'forced player'"
                              [players]="getDefencePlayersForTeam(selectedTeam)"
                              [control]="control"
                            >
                            </app-search-player-in-match-autocomplete>
                          }
                        </div>
                      }
                    }
                  }
                </div>
                <div class="event-fumble">
                  <div class="event-is-fumble">
                    <!--EVENT IS FUMBLE RECOVERED-->
                    @if (
                      getEventIsFumbleRecoveredFormControl(
                        this.eventForm,
                        this.arrayName,
                        i
                      );
                      as control
                    ) {
                      @if (
                        !isPlayResultWithIndex(
                          eventFormGroup,
                          i,
                          eventPlayResultKey,
                          IFootballPlayResult.Flag
                        )
                      ) {
                        @if (getEventIsFumble(eventsArray, i)) {
                          <div class="event-table-cell">
                            <label [attr.for]="'is-fumble-recovered-' + i"
                              >Is Fumble Recovered?</label
                            >
                            <input
                              tuiSwitch
                              type="checkbox"
                              [formControl]="control"
                              size="m"
                              [id]="'is-fumble-recovered-' + i"
                            />
                          </div>
                        }
                      }
                    }
                  </div>
                  <!--EVENT FUMBLE RECOVERED PLAYER-->
                  @if (
                    getEventFumbleRecoveredPlayerFormControl(
                      this.eventForm,
                      this.arrayName,
                      i
                    );
                    as control
                  ) {
                    @if (
                      (!isPlayResultWithIndex(
                        eventFormGroup,
                        i,
                        eventPlayResultKey,
                        IFootballPlayResult.Flag
                      ) &&
                        getEventIsFumbleRecovered(eventsArray, i)) ||
                      getEventFumbleRecoveredPlayer(eventsArray, i)
                    ) {
                      <div class="event-table-cell">
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getAllPlayers()"
                            [control]="control"
                            [placeholder]="'recovered player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'recovered player'"
                            [players]="getAllPlayers()"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                </div>
                <!--BALL PICKED ON FUMBLE & BALL RETURN TO ON FUMBLE-->
                @if (
                  getEventBallPickedOnFumbleFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (isFumble(eventsArray, i)) {
                    <div class="event-ballon-distance">
                      <div
                        [style.background-color]="
                          isCautionColor(
                            noPickBallOnFumbleIsSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (
                          match && match.match_data?.field_length;
                          as fieldLength
                        ) {
                          <app-input-numbers-with-increment-buttons
                            [label]="'Ball Picked'"
                            [control]="control"
                            [min]="-(fieldLength / 2 - 1)"
                            [max]="fieldLength / 2"
                            (incrementEvent)="
                              incrementBallOnPosition(
                                getEventBallPickedOnFumble(eventsArray, i),
                                $event,
                                control,
                                eventsArray,
                                i,
                                fieldLength,
                                eventBallPickedOnKey
                              )
                            "
                          ></app-input-numbers-with-increment-buttons>
                        }
                      </div>
                      @if (
                        getEventBallReturnedToOnFumbleFormControl(
                          this.eventForm,
                          this.arrayName,
                          i
                        );
                        as control
                      ) {
                        <div
                          [style.background-color]="
                            isCautionColor(
                              noReturnBallToOnFumbleIsSelected(eventsArray, i)
                            )
                          "
                        >
                          @if (
                            match && match.match_data?.field_length;
                            as fieldLength
                          ) {
                            <app-input-numbers-with-increment-buttons
                              [label]="'Ball Returned'"
                              [control]="control"
                              [min]="-(fieldLength / 2 - 1)"
                              [max]="fieldLength / 2"
                              (incrementEvent)="
                                incrementBallOnPosition(
                                  getEventBallReturnedToOnFumble(
                                    eventsArray,
                                    i
                                  ),
                                  $event,
                                  control,
                                  eventsArray,
                                  i,
                                  fieldLength,
                                  eventBallReturnedToKey
                                )
                              "
                              [plusOne]="-1"
                              [minusOne]="1"
                            ></app-input-numbers-with-increment-buttons>
                          }
                        </div>
                      }
                    </div>
                  }
                }
                <!--EVENT DEFENCE SCORE PLAYER-->
                @if (
                  getEventDefenceScorePlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (getEventTeam(eventsArray, i); as selectedTeam) {
                    @if (
                      isDefenceScore(eventsArray, i) ||
                      getEventDefenceScorePlayer(eventsArray, i)
                    ) {
                      <div
                        class="event-table-cell"
                        [style.background-color]="
                          isCautionColor(
                            isDefenceScorePlayerSelected(eventsArray, i)
                          )
                        "
                      >
                        @if (isMobile) {
                          <app-select-player-in-match
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                            [placeholder]="'defence score player'"
                          ></app-select-player-in-match>
                        } @else {
                          <app-search-player-in-match-autocomplete
                            [action]="'select'"
                            [placeholder]="'defence score player'"
                            [players]="getDefencePlayersForTeam(selectedTeam)"
                            [control]="control"
                          >
                          </app-search-player-in-match-autocomplete>
                        }
                      </div>
                    }
                  }
                }
                <!--EVENT FLAGGED PLAYER-->
                @if (
                  getEventFlaggedPlayerFormControl(
                    this.eventForm,
                    this.arrayName,
                    i
                  );
                  as control
                ) {
                  @if (
                    isFlagResult(eventsArray, i) ||
                    getEventFlaggedPlayer(eventsArray, i)
                  ) {
                    <div
                      class="event-table-cell"
                      [style.background-color]="
                        isCautionColor(isFlagPlayerSelected(eventsArray, i))
                      "
                    >
                      @if (isMobile) {
                        <app-select-player-in-match
                          [players]="getAllPlayers()"
                          [control]="control"
                          [placeholder]="'flagged player'"
                        ></app-select-player-in-match>
                      } @else {
                        <app-search-player-in-match-autocomplete
                          [action]="'select'"
                          [placeholder]="'flagged player'"
                          [players]="getAllPlayers()"
                          [control]="control"
                        ></app-search-player-in-match-autocomplete>
                      }
                    </div>
                  }
                }
                <!--ACTIONS-->
                @if (deleteOrUpdate === "delete") {
                  @if (eventFormGroup.get("eventId" + i)!.value; as id) {
                    @if (getEventNumber(this.eventsArray, i); as eventNumber) {
                      <div class="table-cell">
                        <app-actions-buttons
                          [id]="id"
                          [index]="i"
                          [deleteOrUpdate]="'delete'"
                          [item]="eventNumber.toString()"
                          (onSubmit)="
                            onSubmitEvent(
                              $event.action,
                              $event.index,
                              $event.id
                            )
                          "
                          [isEnabled]="isFullRowEnabled(eventsArray, i)"
                          [isDataChanged]="isDataChanged(eventsArray, i)"
                          (onEdit)="
                            enableFullRowToEdit(eventsArray, $event.index)
                          "
                          (onCancel)="onCancelButtonClick()"
                          (onDelete)="onDeleteEvent($event.id!)"
                          (onDeleteDialog)="
                            onDeleteButtonClick(
                              'deleteDialogPlayer' + $event.id!
                            )
                          "
                        ></app-actions-buttons>
                      </div>
                    }
                  } @else {
                    <div class="table-cell actions">
                      <app-actions-buttons
                        [index]="i"
                        (onSubmit)="
                          onSubmitEvent($event.action, $event.index, $event.id)
                        "
                        (onCancel)="onCancelButtonClick()"
                      ></app-actions-buttons>
                    </div>
                  }
                }
              }
            </div>
          }
        </div>
        @if (events) {
          @if (!events.length || events[events.length - 1].id !== null) {
            <div class="table-row final">
              <app-add-button-on-final-tr
                [action]="'add event'"
                (onAdd)="addNewEvent()"
              ></app-add-button-on-final-tr>
              <!--                            <app-add-button-on-final-tr-->
              <!--                              [action]="'add flag event'"-->
              <!--                              (onAdd)="addNewEvent('flag')"-->
              <!--                            ></app-add-button-on-final-tr>-->
            </div>
          }
        }
      </div>
    } @else {
      NO EVENTS
      <div class="table-row final">
        <app-add-button-on-final-tr
          (onAdd)="addNewEvent()"
        ></app-add-button-on-final-tr>
        <!--                <app-add-button-on-final-tr-->
        <!--                  [action]="'add flag event'"-->
        <!--                  (onAdd)="addNewEvent('flag')"-->
        <!--                ></app-add-button-on-final-tr>-->
      </div>
    }
  </form>
} @else {
  NO MATCH ID
}
