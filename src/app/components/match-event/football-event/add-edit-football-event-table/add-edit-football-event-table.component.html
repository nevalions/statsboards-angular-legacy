@if (match && match.match_id) {
  <form
    tuiTextfieldSize="m"
    [formGroup]="eventForm"
    [tuiTextfieldLabelOutside]="true"
    style="padding: 10px"
  >
    @if (events && events.length && eventForm && eventsArray && eventsArray.length) {
      <div class="event-table">
        <div formArrayName="events" class="event-table-body">
          <div
            *ngFor="let eventFormGroup of eventsArray.controls; let i = index"
            class="event-table-row"
            [formGroupName]="i"
          >
            <!--EVENT NUMBER-->
            <div class="event-num-qtr-row">
              @if (getEventNumberFormControl(this.eventForm, this.arrayName, i); as control) {
                <div class="event-table-cell">
                  <label>Event Number</label>
                  <tui-input-number
                    [tuiTextfieldCleaner]="true"
                    [min]="1"
                    [step]="1"
                    [formControl]="control">
                  </tui-input-number>
                </div>
              }

              <!--EVENT QTR-->
              @if (getQtrFormControl(this.eventForm, this.arrayName, i); as control) {
                <div class="event-table-cell">
                  <label>Qtr</label>
                  <tui-input-number
                    [min]="1"
                    [max]="4"
                    [step]="1"
                    [tuiTextfieldCleaner]="true"
                    [formControl]="control">
                  </tui-input-number>
                </div>
              }
            </div>

            <!--BALL ON-->
            @if (getBallOnFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                <label>Ball On</label>
                <tui-input-number
                  [tuiTextfieldSize]="'l'"
                  [tuiTextfieldCleaner]="true"
                  [min]="-50"
                  [max]="50"
                  [step]="1"
                  [formControl]="control"
                  (tuiValueChanges)="onBallOnChange(events, eventsArray, $event, i)"
                >
                </tui-input-number>
              </div>
            }


            <!--EVENT TEAM-->
            @if (getEventTeamFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                @if (match && match.teams_data && match.teams_data.team_a && match.teams_data.team_b) {
                  <label>Offence Team</label>
                  <app-select-team-in-match
                    [placeholder]="'offence team'"
                    [teamsList]="[match.teams_data.team_a, match.teams_data.team_b]"
                    [control]="control"
                    (teamSelected)="onTeamChange(eventsArray, $event, i)"
                  ></app-select-team-in-match>
                }
              </div>
            }

            <!--EVENT QB-->
            @if (getEventQbFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                @if (getEventTeam(eventsArray, i); as selectedTeam) {
                  <label>QB</label>
                  <app-search-player-in-match-autocomplete
                    [action]="'select'"
                    [placeholder]="'qb'"
                    [players]="getPlayersForSelectedTeam(selectedTeam)"
                    [control]="control">
                  </app-search-player-in-match-autocomplete>
                }
              </div>
            }


            <!--EVENT DOWN-->
            <div class="event-table-cell">
              <div class="event-down-distance">
                @if (getEventDownFormControl(this.eventForm, this.arrayName, i); as control) {
                  <div class="event-down">
                    <label>Down</label>
                    <tui-input-number
                      [tuiTextfieldCleaner]="true"
                      [min]="1"
                      [max]="4"
                      [step]="1"
                      (tuiValueChanges)="onDownChange(eventsArray, $event, i)"
                      [formControl]="control">
                    </tui-input-number>
                  </div>
                }
                @if (getEventDistanceFormControl(this.eventForm, this.arrayName, i); as control) {
                  <div class="event-distance">
                    <label>Distance</label>
                    <tui-input-number
                      [tuiTextfieldCleaner]="true"
                      [min]="1"
                      [max]="100"
                      [step]="1"
                      [formControl]="control">
                    </tui-input-number>
                  </div>
                }
              </div>
            </div>

            <!--EVENT HASH-->
            <div class="event-hash-type">
              @if (getEventHashFormControl(this.eventForm, this.arrayName, i); as control) {
                <div class="event-table-cell">
                  <label>Hash</label>
                  <app-select-enum
                    [control]="control"
                    [placeholder]="'hash'"
                    [enumObjects]="eventHashOptions"
                  ></app-select-enum>
                </div>
              }
              <!--EVENT PLAY TYPE-->
              @if (getEventPlayTypeFormControl(this.eventForm, this.arrayName, i); as control) {
                <div class="event-table-cell">
                  <label>Play Type</label>
                  <app-select-enum
                    [control]="control"
                    [placeholder]="'play type'"
                    [enumObjects]="eventPlayTypeOptions"
                    (itemSelected)="onPlayTypeChange(this.eventsArray, $event, i)"
                  ></app-select-enum>
                </div>
              }
            </div>

            <!--EVENT PLAY RESULT-->
            @if (getEventPlayResultFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                <label>Play Result</label>
                <app-select-enum
                  [control]="control"
                  [placeholder]="'play result'"
                  [enumObjects]="eventPlayResultOptions"
                ></app-select-enum>
              </div>
            }

            <!--EVENT RUN PLAYER-->
            @if (getEventRunPlayerFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                @if (getEventTeam(eventsArray, i); as selectedTeam) {
                  @if (isPlayType(eventFormGroup, i, 'eventPlayType', IFootballPlayType.Run)) {
                    <label>Run Player</label>
                    <app-search-player-in-match-autocomplete
                      [action]="'select'"
                      [placeholder]="'run player'"
                      [players]="getPlayersForSelectedTeam(selectedTeam)"
                      [control]="control">
                    </app-search-player-in-match-autocomplete>
                  }
                }
              </div>
            }

            <!--EVENT PASS PLAYER-->
            @if (getEventReceiverPlayerFormControl(this.eventForm, this.arrayName, i); as control) {
              <div class="event-table-cell">
                @if (getEventTeam(eventsArray, i); as selectedTeam) {
                  @if (isPlayType(eventFormGroup, i, 'eventPlayType', IFootballPlayType.Pass)) {
                    <label>Receiver Player</label>
                    <app-search-player-in-match-autocomplete
                      [action]="'select'"
                      [placeholder]="'receiver player'"
                      [players]="getPlayersForSelectedTeam(selectedTeam)"
                      [control]="control">
                    </app-search-player-in-match-autocomplete>
                  }
                }
              </div>
            }


            <!--ACTIONS-->
            @if (deleteOrUpdate == "delete") {
              @if (eventFormGroup.get("eventId" + i)!.value; as id) {
                @if (getEventNumber(this.eventsArray, i); as eventNumber) {
                  <div class="table-cell">
                    <app-actions-buttons
                      [id]="id"
                      [index]="i"
                      [deleteOrUpdate]="'delete'"
                      [item]="eventNumber.toString()"
                      (onSubmit)="onSubmitNewEvent($event.action, $event.index, $event.id)"
                      [isEnabled]="isFullRowEnabled(eventsArray, i)"
                      [isDataChanged]="isDataChanged(eventsArray, i)"
                      (onEdit)="enableFullRowToEdit(eventsArray, $event.index)"
                      (onCancel)="onCancelButtonClick()"
                      (onDelete)="onDeleteEvent($event.id!)"
                      (onDeleteDialog)="onDeleteButtonClick('deleteDialogPlayer' + $event.id!)"
                    ></app-actions-buttons>
                  </div>
                }
              } @else {
                <div class="table-cell actions">
                  <app-actions-buttons
                    [index]="i"
                    (onSubmit)="onSubmitNewEvent($event.action, $event.index, $event.id)"
                    (onCancel)="onCancelButtonClick()"
                  ></app-actions-buttons>
                </div>
              }
            }
          </div>
        </div>
        @if (events) {
          @if (!events.length || events[events.length - 1].id !== null) {
            <div class="table-row final">
              <app-add-button-on-final-tr
                [action]="'add event'"
                (onAdd)="addNewEvent()"
              ></app-add-button-on-final-tr>
            </div>
          }
        }

      </div>
    } @else {
      NO EVENTS
      <div class="table-row final">
        <app-add-button-on-final-tr
          (onAdd)="addNewEvent()"
        ></app-add-button-on-final-tr>
      </div>
    }
  </form>
} @else {
  NO MATCH ID
}
