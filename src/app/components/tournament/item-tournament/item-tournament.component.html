<div class="tournament content__title">
  @if (this.tournament$ | async; as tournament) {
    <h3 class="tui-text_h3">
      {{ tournament.title | uppercase }}
    </h3>
    <p class="content__title_description">{{ tournament.description }}</p>
  } @else {
    <h3 class="tui-text_h3">
      <tui-loader [inheritColor]="true"></tui-loader>
    </h3>
  }
</div>

<div class="tournament content__body">
  <div class="one_col_container">
    @if (this.tournament$ | async; as tournament) {
      <div class="tournament content__body__title__flex">
        <app-body-title
          titleMany='matches'
        ></app-body-title>
        @if (tournament.id) {
          @if (teamsInTournament$ | async; as teams) {
            <app-add-edit-match
              [tournamentId]="tournament.id"
              [teams$]="teamsInTournament$"
              [addMatch]="matchWithFullDataService.addMatchWithFullData.bind(matchWithFullDataService)"
            ></app-add-edit-match>
          }
        } @else {
          <tui-loader></tui-loader>
        }
        <app-delete-dialog
          [item]="'Tournament'"
          (delete)="onDelete()"
        ></app-delete-dialog>

      </div>
    } @else {
      <tui-loader [inheritColor]="true"></tui-loader>
    }
    <div class="tournament with__aside">
      <div class="one_col_container">
        @if (matchesWithFullData$ | async; as items) {
          <div class="filters flex__fullwidth_center">
            <form
              [formGroup]="formWeek"
            >
              <tui-input-number
                formControlName="matchWeekSearch"
                (tuiValueChanges)="onSearch()"
              >
                Search by WEEK
              </tui-input-number>
            </form>

            <app-form-search-text
              [data$]="matchesWithFullData$"
              [searchTitle]="'team'"
              [parameter]="'teams_data.team_a.title + teams_data.team_b.title'"
              [filter]="'includes'"
            ></app-form-search-text>

            <app-pagination-with-items-per-page
              [items$]="matchesWithFullData$"
            ></app-pagination-with-items-per-page>


          </div>
          <div class="list-of-items-with-data" style="padding: 20px">

            <app-list-of-matches
              [data$]="paginationService.paginatedItems$"
              [formatPath]='matchHref'
            >
            </app-list-of-matches>

          </div>
        } @else {
          <tui-loader [inheritColor]="true"></tui-loader>
        }
      </div>


      <aside>
        <h4 style="text-align: center">TEAMS</h4>
        @if (tournament$ | async; as tournament) {
          @if (teamsInTournament$ | async; as teams) {
            @for (team of teams; track team.id) {

              <tui-elastic-container>
                <div style="display: flex; justify-content: space-between; align-items: center">
                  <button
                    appearance="whiteblock"
                    size="xl"
                    tuiButton
                    type="button"
                    style="width: 80%"
                    (click)="navigateTo(teamItemHref(team))"
                  > {{ team.title }}
                  </button>
                  <button
                    appearance="flat"
                    icon="tuiIconClose"
                    shape="rounded"
                    size="s"
                    title="Remove"
                    tuiIconButton
                    (click)="onTeamRemoveFromTournament(team.id!, tournament.id!)"
                  ></button>
                </div>
              </tui-elastic-container>

            }
          } @else {
            <tui-loader></tui-loader>
          }
        }
        @if (this.tournament$ | async; as tournament) {
          <app-add-team-to-tournament
            [tournamentId]="tournament.id!"
            [sportId]="tournament.sport_id"
          ></app-add-team-to-tournament>
        }
      </aside>
    </div>

  </div>
</div>

<!--    <div class="filters flex__fullwidth_center">-->


<!--      <form-->
<!--        style="padding: 10px"-->
<!--        [formGroup]="testForm"-->
<!--      >-->
<!--        <tui-input-->
<!--          formControlName="nameValue"-->
<!--        >-->
<!--          Search by WEEK-->
<!--          <input-->
<!--            style="min-width: max-content"-->
<!--            (change)="onSearch()"-->
<!--            tuiTextfield-->
<!--          />-->
<!--        </tui-input>-->
<!--      </form>-->

<!--      <form-->
<!--        style="padding: 10px"-->
<!--        [formGroup]="testForm"-->
<!--      >-->
<!--        <tui-input-number-->
<!--          formControlName="nameValue"-->
<!--          class="b-form"-->
<!--          (tuiValueChanges)="onSearch()"-->
<!--        >-->
<!--          WEEK-->
<!--        </tui-input-number>-->

<!--      </form>-->


<!--      <div class="" style="display: grid; padding: 10px">FILTER</div>-->
<!--      <div class="" style="display: grid; padding: 10px">FILTER</div>-->
<!--      <div class="" style="display: grid; padding: 10px">FILTER</div>-->
<!--      <div class="" style="display: grid; padding: 10px">FILTER</div>-->


<!--    </div>-->


<!--    <div class="search block__fullwidth_center">-->

<!--          <div class="" style="display: block; padding: 10px; min-width: 100%">-->
<!--            <div class="tui-form__row">-->
<!--            <form-->
<!--              [formGroup]="testForm"-->
<!--            >-->
<!--                <tui-input-->
<!--                  formControlName="nameValue"-->
<!--                >-->
<!--                  Search by WEEK-->
<!--                  <input-->
<!--                    style="min-width: max-content"-->
<!--                    (change)="onSearch()"-->
<!--                    tuiTextfield-->
<!--                  />-->
<!--                </tui-input>-->


<!--            </form>-->
<!--            </div>-->
<!--          </div>-->


<!--      <div class="" style="display: block; padding: 10px;">-->
<!--        <div class="tui-form__row">-->

<!--        </div>-->
<!--      </div>-->

<!--    </div>-->

<!--    @if (matches$ | async; as matches) {-->
<!--      @if (matches.length > itemsPerPage) {-->
<!--        <div class="pagination" style="display: grid">-->
<!--          <tui-pagination-->
<!--            [index]="currentPageIndex - 1"-->
<!--            [length]="Math.ceil(matches.length / itemsPerPage)"-->
<!--            (indexChange)="setPage($event + 1)"-->
<!--          ></tui-pagination>-->
<!--        </div>-->
<!--      }-->
<!--    }-->


<!--            <form-->
<!--              class="b-form"-->
<!--              [formGroup]="form"-->
<!--              style="width: 60%"-->
<!--            >-->
<!--              <tui-input-->
<!--                formControlName="match"-->
<!--              >-->
<!--                Match Week-->
<!--                <tui-data-list-wrapper-->
<!--                  *tuiDataList-->
<!--                  [itemContent]="stringify | tuiStringifyContent"-->
<!--                  [items]="items | tuiFilterByInput: matcherM"-->
<!--                ></tui-data-list-wrapper>-->
<!--              </tui-input>-->
<!--            </form>-->
<!--            <form-->
<!--              [formGroup]="matchWeekSearchForm"-->
<!--            >-->
<!--              &lt;!&ndash;              <tui-input-number&ndash;&gt;-->
<!--              &lt;!&ndash;                formControlName="matchWeek"&ndash;&gt;-->
<!--              &lt;!&ndash;                class="b-form"&ndash;&gt;-->
<!--              &lt;!&ndash;                (tuiValueChanges)="onSearch()"&ndash;&gt;-->
<!--              &lt;!&ndash;              >&ndash;&gt;-->
<!--              &lt;!&ndash;                WEEK&ndash;&gt;-->
<!--              &lt;!&ndash;              </tui-input-number>&ndash;&gt;-->

<!--            </form>-->


<!--    <div class="list-of-items-with-data" style="padding: 20px">-->
<!--      @if (matches$ | async; as matches) {-->
<!--        <app-list-of-matches-->
<!--          [data$]="matches | slice: (currentPageIndex - 1) * itemsPerPage : currentPageIndex * itemsPerPage"-->
<!--          [formatPath]='matchHref'-->
<!--        >-->
<!--        </app-list-of-matches>-->
<!--      }-->
<!--    </div>-->
