<div class="tournament content__title">
  @if (this.tournament$ | async; as tournament) {
    <h3 class="tui-text_h3">
      {{ tournament.title | uppercase }}
    </h3>
    <p style="text-align: center">
      <img
        src="{{url}}{{tournament.tournament_logo_web_url}}"
        width="200px"
        alt="{{tournament.title | uppercase}} Logo"
      >
    </p>

    @if (currentTournamentMainSponsor$ | async; as sponsor) {
      <p style="text-align: center">Main Sponsor</p>
      <!--      <p style="text-align: center">{{ sponsor.title }}</p>-->
      <p style="text-align: center">
        <img
          src="{{url}}{{sponsor.logo_url}}"
          width="200px"
          alt="{{sponsor.title | uppercase}} Logo"
        >
      </p>
    }
    @if (sponsorLine$ | async; as sponsorLine) {
      <div class="tournament_sponsor_line">
        <app-sponsor-line
          [sponsorLine]="sponsorLine"
        ></app-sponsor-line>
      </div>
    }
    <p class="content__title_description">{{ tournament.description }}</p>
  } @else {
    <h3 class="tui-text_h3">
      <tui-loader [inheritColor]="true"></tui-loader>
    </h3>
  }

  <div class="one_row_container">
    @if (this.tournament$ | async; as tournament) {
      <app-edit-button
        [action]="'edit'"
        [item]="'Tournament'"
        [dialogId]="'editTournamentDialog'"
      ></app-edit-button>

      <app-tournament-add-edit-form
        [action]="'edit'"
        [dialogId]="'editTournamentDialog'"
        [new_tournament]="tournament"
        [allSponsors]="allSponsors$ | async"
        [allSponsorLines]="allSponsorLines$ | async"
      ></app-tournament-add-edit-form>

      @if (teamsInTournament$ | async; as teams) {

        <app-create-button-show-dialog
          [action]="'add'"
          [item]="'Match'"
          [dialogId]="'addDialog'"
        ></app-create-button-show-dialog>
        <app-add-edit-match
          [action]="'add'"
          [dialogId]="'addDialog'"
          [tournamentId]="tournament.id!"
          [teams]="teams"
        ></app-add-edit-match>

        @if (allAvailablePlayersToAddInTournament$ | async; as players) {
          @if (sport$ | async; as sport) {
            @if (tournament$ | async; as tournament) {
              <app-edit-button
                [action]="'add'"
                [item]="'Player'"
                [dialogId]="'addPlayerDialog'"
              ></app-edit-button>

              <app-add-edit-player-to-team-tournament
                [action]="'add'"
                [dialogId]="'addPlayerDialog'"
                [availablePlayers]="players"
                [sportPositions]="allSportPositions$| async"
                [sport_Id]="sport.id!"
                [tournamentId]="tournament.id!"
                [tournamentTeams]="teams"
              ></app-add-edit-player-to-team-tournament>
            }
          }
        }
      }
      <app-delete-button
        [item]="buttonTitle"
        [dialogId]="'deleteDialog'"
      ></app-delete-button>
      <app-delete-dialog
        [item]="buttonTitle"
        (delete)="onDelete()"
        [dialogId]="'deleteDialog'"
      ></app-delete-dialog>
    } </div>
</div>

<div class="tournament content__body">
  <div class="one_col_container">
    <app-body-list-title
      titleMany='matches'
    ></app-body-list-title>

    <div class="tournament with__aside">
      <div class="one_col_container">
        @if (matchesInTournament$ | async; as items) {
          <div class="filters flex__fullwidth_center">
            <form
              [formGroup]="formWeek"
            >
              <tui-input-count
                [tuiTextfieldCleaner]="true"
                formControlName="matchWeekSearch"
                (tuiValueChanges)="onSearchByWeek($event)"
              >
                Search by WEEK
              </tui-input-count>
            </form>

            <app-base-search-form
              [placeholder]="'Team title'"
              (search)="onSearch($event)"
            ></app-base-search-form>
          </div>
          <div class="one_col_container">
            @if (totalMatchCombinedSearchPages$ | async; as totalPages) {
              @if (currentPage$ | async; as currentPage) {
                <app-base-pagination
                  [currentPage]="currentPage"
                  [totalPages]="totalPages"
                  [itemsPerPage]="6"
                  (pageChange)="setCurrentPage($event)"
                  (pageSizeChange)="changePageSize($event)"
                ></app-base-pagination>
              }
            }
          </div>
          <div class="list-of-items-with-data" style="padding: 20px">
            <app-list-of-matches
              [data$]="paginatedMatchCombinedSearchResults$"
            ></app-list-of-matches>
          </div>

          <div class="one_col_container">
            <app-body-list-title
              titleMany="teams"
            ></app-body-list-title>

            @if (sport$ | async; as sport) {
              @if (tournament$ | async; as tour) {
                @if (teamsInTournament$ | async; as t) {
                  @if (allSportTeams$ |async; as availableTeams) {
                    <app-add-edit-team-to-tournament-table
                      [tournamentId]="tour.id!"
                      [teams]="t"
                      [sportId]="sport.id!"
                      [availableTeamInSport]="availableTeams"
                    ></app-add-edit-team-to-tournament-table>
                  }
                }
              }
            }



            <!--        <h4 style="text-align: center">TEAMS</h4>-->
            <!--        @if (tournament$ | async; as tournament) {-->
            <!--          @if (teamsInTournament$ | async; as teams) {-->
            <!--            @for (team of teams; track team.id) {-->
            <!--              <tui-elastic-container>-->
            <!--                <div style="display: flex; justify-content: space-between; align-items: center">-->
            <!--                  <button-->
            <!--                    appearance="whiteblock"-->
            <!--                    size="xl"-->
            <!--                    tuiButton-->
            <!--                    type="button"-->
            <!--                    style="width: 80%"-->
            <!--                    (click)="navigateToTeamItem(team)"-->
            <!--                  > {{ team.title | titlecase }}-->
            <!--                  </button>-->
            <!--                              <app-delete-button-icon-->
            <!--                                [dialogId]="'removeDialog' + team.id"-->
            <!--                              ></app-delete-button-icon>-->
            <!--                              <app-remove-dialog-->
            <!--                                [item]="team.title | uppercase"-->
            <!--                                [dialogId]="'removeDialog' + team.id"-->
            <!--                                (delete)="onTeamRemoveFromTournament(team.id!, tournament.id!)"-->
            <!--                              ></app-remove-dialog>-->
            <!--                </div>-->
            <!--              </tui-elastic-container>-->

            <!--            }-->
            <!--          } @else {-->
            <!--            <tui-loader></tui-loader>-->
            <!--          }-->
            <!--          <app-create-button-show-dialog-->
            <!--            [item]="'Team'"-->
            <!--            [dialogId]="'addTeamToTournamentDialog' + tournament.id"-->
            <!--          ></app-create-button-show-dialog>-->
            <!--          <app-add-team-to-tournament-->
            <!--            [tournamentId]="tournament.id!"-->
            <!--            [dialogId]="'addTeamToTournamentDialog' + tournament.id"-->
            <!--            [allSportTeams$]="allSportTeams$"-->
            <!--            [teamsInTournament$]="teamsInTournament$"-->
            <!--          ></app-add-team-to-tournament>-->
            <!--        }-->
          </div>

          <div class="one_col_container">
            <app-body-list-title
              titleMany='players'
            ></app-body-list-title>

            @if (sport$ | async; as sport) {
              @if (tournament$ | async; as tournament) {
                @if (paginatedTablePlayerInTeamTournament$ | async; as players) {
                  <!--                @if (allPlayerInTournamentFullData$ | async; as players) {-->
                  @if (allSportPlayersWithPerson$ | async; as playersInSports) {
                    @if (allAvailablePlayersToAddInTournament$ | async; as availablePlayers) {

                      <app-add-edit-player-to-team-tournament-table
                        [deleteOrUpdate]="'delete'"
                        [sportId]="sport.id!"
                        [tournamentId]="tournament.id!"
                        [teamsInTournament]="teamsInTournament$|async"
                        [playersInSport]="playersInSports"
                        [players]="players"
                        [availablePlayersInSport]="availablePlayers"
                        [positions]="allSportPositions$ | async"
                      ></app-add-edit-player-to-team-tournament-table>

                    }
                  }
                }
              }
            } @else {
              <tui-loader></tui-loader>
            }

            @if (totalPlayersInTeamTournament$ | async; as totalPages) {
              @if (currentPlayersInTournamentPage$ | async; as currentPage) {
                <app-base-pagination
                  [currentPage]="currentPage"
                  [totalPages]="totalPages"
                  [itemsPerPage]="10"
                  (pageChange)="setPlayerInTournamentCurrentPage($event)"
                  (pageSizeChange)="changePlayerInTournamentPageSize($event)"
                ></app-base-pagination>
              }
            }


          </div>
        } @else {
          <tui-loader [inheritColor]="true"></tui-loader>
        }
      </div>


      <!--      <aside>-->
      <!--        <h4 style="text-align: center">TEAMS</h4>-->
      <!--        @if (tournament$ | async; as tournament) {-->
      <!--          @if (teamsInTournament$ | async; as teams) {-->
      <!--            @for (team of teams; track team.id) {-->
      <!--              <tui-elastic-container>-->
      <!--                <div style="display: flex; justify-content: space-between; align-items: center">-->
      <!--                  <button-->
      <!--                    appearance="whiteblock"-->
      <!--                    size="xl"-->
      <!--                    tuiButton-->
      <!--                    type="button"-->
      <!--                    style="width: 80%"-->
      <!--                    (click)="navigateToTeamItem(team)"-->
      <!--                  > {{ team.title | titlecase }}-->
      <!--                  </button>-->
      <!--                  <app-delete-button-icon-->
      <!--                    [dialogId]="'removeDialog' + team.id"-->
      <!--                  ></app-delete-button-icon>-->
      <!--                  <app-remove-dialog-->
      <!--                    [item]="team.title | uppercase"-->
      <!--                    [dialogId]="'removeDialog' + team.id"-->
      <!--                    (delete)="onTeamRemoveFromTournament(team.id!, tournament.id!)"-->
      <!--                  ></app-remove-dialog>-->
      <!--                </div>-->
      <!--              </tui-elastic-container>-->

      <!--            }-->
      <!--          } @else {-->
      <!--            <tui-loader></tui-loader>-->
      <!--          }-->
      <!--          <app-create-button-show-dialog-->
      <!--            [item]="'Team'"-->
      <!--            [dialogId]="'addTeamToTournamentDialog' + tournament.id"-->
      <!--          ></app-create-button-show-dialog>-->
      <!--          <app-add-team-to-tournament-->
      <!--            [tournamentId]="tournament.id!"-->
      <!--            [dialogId]="'addTeamToTournamentDialog' + tournament.id"-->
      <!--            [allSportTeams$]="allSportTeams$"-->
      <!--            [teamsInTournament$]="teamsInTournament$"-->
      <!--          ></app-add-team-to-tournament>-->
      <!--        }-->
      <!--      </aside>-->
    </div>

  </div>
</div>
